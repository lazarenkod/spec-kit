# Extraction Manifest
# Generated by /speckit.reverse-engineer

version: "1.0"
extracted_at: "{{ISO_DATE}}"
extracted_by: "/speckit.reverse-engineer"

# Scan configuration
scan_scope:
  patterns:
    - "{{pattern1}}"
    - "{{pattern2}}"
  exclude:
    - "node_modules/"
    - "dist/"
    - "build/"
    - "__pycache__/"
    - "venv/"
    - ".git/"

# Baseline (if canonical spec exists)
baseline:
  spec_version: "{{spec_version}}"  # null if no canonical spec
  spec_checksum: "{{spec_checksum}}"  # SHA-256 of canonical spec.md

# Extraction results
extraction_results:
  discovered_files: {{discovered_files_count}}
  analyzed_symbols: {{analyzed_symbols_count}}

  extracted_requirements:
    total: {{total_frs}}
    by_confidence:
      explicit: {{explicit_count}}      # 0.90-1.00 (has @speckit annotation)
      high: {{high_count}}              # 0.70-0.89 (clear naming + tests)
      medium: {{medium_count}}          # 0.50-0.69 (inferred from patterns)
      low: {{low_count}}                # 0.00-0.49 (speculative, needs review)

  extracted_scenarios: {{total_ass}}

  by_source:
    explicit_annotation: {{explicit_annotation_count}}
    api_inference: {{api_inference_count}}
    entity_inference: {{entity_inference_count}}
    test_conversion: {{test_conversion_count}}

# Drift summary (if canonical spec exists)
drift_summary:
  spec_to_code:
    missing_in_code: {{only_in_canonical_count}}
  code_to_spec:
    missing_in_spec: {{only_in_extracted_count}}
  semantic_differences: {{semantic_diff_count}}

# Confidence statistics
confidence_stats:
  average: {{average_confidence}}
  median: {{median_confidence}}
  min: {{min_confidence}}
  max: {{max_confidence}}
  std_dev: {{std_dev_confidence}}

# Language detection
language_breakdown:
  primary: "{{primary_language}}"  # typescript, python, go, java, kotlin
  detected_frameworks:
    - "{{framework1}}"
    - "{{framework2}}"
  files_by_language:
    typescript: {{ts_file_count}}
    python: {{py_file_count}}
    go: {{go_file_count}}
    java: {{java_file_count}}
    kotlin: {{kotlin_file_count}}

# Quality metrics
quality_metrics:
  hallucination_warnings: {{hallucination_count}}
  low_confidence_items: {{low_confidence_count}}  # < 0.70
  coverage:
    apis_with_fr: {{apis_with_fr_percentage}}%
    tests_converted: {{tests_converted_percentage}}%

# Traceability
traceability:
  apis_discovered: {{apis_discovered_count}}
  entities_discovered: {{entities_discovered_count}}
  tests_analyzed: {{tests_analyzed_count}}
  existing_annotations_found: {{existing_annotations_count}}

# Recommendations
recommendations:
  - "{{recommendation1}}"
  - "{{recommendation2}}"
  # Example: "Review FR-003 to FR-007 (low confidence < 0.60)"
  # Example: "Verify entity-inferred requirements against actual usage"

# Warnings
warnings:
  - severity: "{{severity}}"
    message: "{{warning_message}}"
  # Example:
  # - severity: "HIGH"
  #   message: "15 FRs have confidence < 0.60 - likely hallucinations"

# Output files
output_files:
  extracted_spec: "reverse-engineered/extracted-spec.md"
  drift_report: "reverse-engineered/drift-report.md"
  extraction_log: "reverse-engineered/extraction-log.md"
  manifest: "reverse-engineered/.extraction-manifest.yaml"
